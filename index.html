<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Imagen Flotante 3D con Transparencia</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: transparent;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            font-family: Arial;
            z-index: 100;
            border-radius: 5px;
        }
        a-scene {
            background: transparent !important;
        }
    </style>
</head>
<body>
    <!-- Mensaje informativo -->
    <div id="info">
        Mueve el ratón para mirar alrededor<br>
        Usa WASD o flechas para moverte
    </div>

    <a-scene background="color: transparent" renderer="alpha: true">
        <!-- Imagen PNG con transparencia -->
        <a-image 
            src="https://cdn.aframe.io/test-mono-compat.png"  <!-- Cambia por tu imagen PNG con transparencia -->
            transparent="true"
            alpha-test="0.5"
            position="0 1.5 -2"
            width="1.5"
            height="1.5"
            animation__position="property: position; to: 0 2 -2; dir: alternate; loop: true; dur: 3000; easing: easeInOutSine"
            animation__rotation="property: rotation; to: 0 360 0; loop: true; dur: 15000; easing: linear"
            animation__scale="property: scale; to: 1.1 1.1 1.1; dir: alternate; loop: true; dur: 2000; easing: easeInOutSine"
            shadow="receive: false">
        </a-image>

        <!-- Luces para mejor visualización -->
        <a-entity light="type: ambient; color: #888; intensity: 0.8"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 1.2" 
                 position="-1 2 1" cast-shadow></a-entity>
        <a-entity light="type: point; color: #88F; intensity: 0.5" 
                 position="1 1 -1" distance="5" decay="1"></a-entity>

        <!-- Cámara con movimiento suavizado -->
        <a-entity 
            position="0 1.6 3"
            movement-controls="fly: true; speed: 0.3; constrainToNavMesh: false">
            <a-entity 
                camera="fov: 70; near: 0.1; far: 1000"
                look-controls="pointerLockEnabled: true"
                wasd-controls="enabled: true">
            </a-entity>
        </a-entity>

        <!-- Efecto de partículas para ambiente -->
        <a-entity particle-system="preset: snow; color: #AAA; particleCount: 200"></a-entity>
    </a-scene>

    <script>
        // Configuración adicional para transparencia
        document.querySelector('a-scene').addEventListener('loaded', function() {
            const renderer = this.renderer;
            renderer.sortObjects = true;
            renderer.alpha = true;
            renderer.setClearColor(0x000000, 0);
            
            // Verificar si la imagen cargó correctamente
            const image = document.querySelector('a-image');
            image.addEventListener('loaded', function() {
                console.log('Imagen cargada correctamente');
                // Asegurar que la transparencia funcione
                this.object3D.children[0].material.transparent = true;
                this.object3D.children[0].material.needsUpdate = true;
            });
            
            image.addEventListener('error', function() {
                console.warn('Error al cargar la imagen');
                fallbackImage(this);
            });
        });

        function fallbackImage(element) {
            console.warn("No se pudo cargar la imagen, usando respaldo");
            element.setAttribute('src', 'https://scontent.fmdz7-1.fna.fbcdn.net/v/t39.30808-6/474838171_9426793647351680_1267474936689448151_n.jpg?_nc_cat=100&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeHMggktZZoWIXOTp4f6gY3K4LTsvs0kb8LgtOy-zSRvwmz3XHNgyBv8fnH8HFv3auaTkhrHrRHdGisnYQSDwobf&_nc_ohc=1wv8ifHe1eoQ7kNvwEJA8JC&_nc_oc=AdkXJtlpW_RdhzORx_Jd05QJPX5o7j-8S4Glxg-LUUssuF2Dk_Y8VeJbpvSawXMJ2o2N0WaXK-qek24qgpCbdJao&_nc_zt=23&_nc_ht=scontent.fmdz7-1.fna&_nc_gid=TZLJQes6eNpbb69H8uY-rA&oh=00_AfXIFlKG-QyQd8Ph0kji0gT_6u8W0SGah0co2b4eP1DRPA&oe=689AA553');
            element.setAttribute('material', 'transparent', 'true');
            element.setAttribute('material', 'alphaTest', '0.5');
            
            const errorText = document.createElement('a-text');
            errorText.setAttribute('value', 'Error: Imagen no encontrada\nUsando imagen de prueba');
            errorText.setAttribute('position', '0 1 -2');
            errorText.setAttribute('align', 'center');
            errorText.setAttribute('color', 'red');
            errorText.setAttribute('width', '3');
            element.parentNode.appendChild(errorText);
        }
    </script>
</body>
</html>